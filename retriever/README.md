# Ретривер — векторизатор вопросов и ответов

Тут находится код для обучения моделей ретривера, первого этапа пайплайна RAG, 
который позволяет быстро отобрать N документов из базы знаний, релевантных вопросу пользователя.


## Данные
Для подготовки датасета для обучения нужно запустить скрипт `make_splits_new.py`, 
указав в переменной `src_csv_file` путь до csv файла, содержащего колонки
`question;answer;classifier_1;classifier_2;is_knowledge_base`, а в переменной `synth_dir` путь до директории, 
содержащей json файлы со сгенерированными с помощью проприентарной модели дополнительными вопросами. 
В результате получится файл `train_val_test.json`, в котором будет train-test сплит + трейн, побитый на 5 фолдов.


## Обучение
Обучение конфигурируется из конфига `configs/default.yaml`. Для запуска обучения достаточно выполнить `python3 train.py`